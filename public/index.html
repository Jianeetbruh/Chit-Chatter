<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chit-Chatter</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="container">
    <h1>Welcome to Chit-Chatter</h1>

    <div class="form-box">
      <input id="username" type="text" placeholder="Enter Username" />
      <input id="password" type="password" placeholder="Enter Password" />

      <button onclick="login()">Login</button>
      <button onclick="register()">Register</button>

      <p id="msg"></p>
    </div>
  </div>
<script>
function showError(msg) {
  document.getElementById("msg").innerText = msg;
  setTimeout(() => {
    document.getElementById("msg").innerText = "";
  }, 3000);
}

async function register() {
  let username = document.getElementById("username").value.trim();
  let password = document.getElementById("password").value.trim();

  if (username === "" || password === "") {
    return showError("Username & Password cannot be empty!");
  }

  let res = await fetch("/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ username, password })
  });

  let data = await res.json();
  
  if (!res.ok) {
    showError(data.error);
    return;
  }

  window.location.href = "/chat.html";
}

async function login() {
  let username = document.getElementById("username").value.trim();
  let password = document.getElementById("password").value.trim();

  if (username === "" || password === "") {
    return showError("Username & Password cannot be empty!");
  }

  let res = await fetch("/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ username, password })
  });

  let data = await res.json();

  if (!res.ok) {
    showError(data.error);
    return;
  }

  window.location.href = "/chat.html";
}
</script>

</body>
</html>

